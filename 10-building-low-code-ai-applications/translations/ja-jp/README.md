# ローコード AI アプリケーションの構築

[![Building Low Code AI Applications](../../images/10-lesson-banner.png?WT.mc_id=academic-105485-yoterada)](https://learn.microsoft.com/_themes/docs.theme/master/en-us/_themes/global/video-embed.html?id=170c6cb7-3c96-40f2-a354-b6f0ec523de7?WT.mc_id=academic-105485-yoterada)

> _(上記の画像をクリックすると、レッスン・ビデオを表示します)_

## はじめに

画像生成アプリケーションの作り方を学んだところで、次にローコード開発について会話をうつしましょう。生成 AI はローコード開発を含む様々な環境で利用できますが、ローコードとは何でしょうか。また、それをどのように AI に組み込めるのでしょうか。

ローコード開発プラットフォームの利用により、従来の開発者や開発未経験者でもアプリケーションやソリューションの作成が簡単になりました。ローコード開発プラットフォームを使うと、ほぼコードを書かずに、もしくは全く書かずに、アプリケーションやソリューションを作れます。これは、コンポーネントをドラッグ・アンド・ドロップで配置できるビジュアル開発環境を提供しているため、それを利用して実現できます。これにより、アプリケーションやソリューションをより速く、リソースも少なく作れます。このレッスンでは、ローコード開発プラットフォームの使い方と、Power Platform を使い AI を活用したローコード開発の方法について詳しく説明します。

Power Platform は、直感的なローコードまたはノーコードの開発環境を通じて、組織のチーム・メンバーが自分自身でソリューションを作れるような機会を提供します。この環境は、ソリューション作成のプロセスを大幅に簡素化します。Power Platform を使えば、ソリューションを数ヶ月や数年かけて作るのではなく、数日や数週間で作れるようになります。Power Platform は、Power Apps、Power Automate、Power BI、Copilot Studio の 5 つの主要製品から構成されています。

このレッスンでは、下記の内容について説明します。

- Power Platform における生成 AI の紹介
- Copilot の紹介と使い方
- 生成 AI を使って Power Platform でアプリとフローを作る方法
- AI Builder を使って Power Platform の AI モデルを理解する方法

## 学習目標

このレッスンを修了すると、下記を理解できます：

- Copilot が Power Platform でどのように機能するかを理解します

- 教育スタートアップによる、学生の課題追跡アプリを構築します。

- AI を使用して請求書から情報を抽出する請求書処理フローを構築します。

- GPT モデルを使用してテキスト生成をする際の、ベスト・プラクティスを適用します。

このレッスンで使用するツールとテクノロジは下記のとおりです。

- **Power Apps**: データを追跡、管理、操作するアプリを作るためのローコード開発環境を提供し、これを利用し学生の課題追跡アプリを作ります。

- **Dataverse**: 学生の課題追跡アプリのデータを格納するために使います。Dataverse はアプリのデータを格納するためのローコード・データ・プラットフォームを提供します。

- **Power Automate**: 請求書処理フローを作るためのローコード開発環境を提供し、これを使って請求書処理プロセスを自動化します。

- **AI Builder**: 事前に作成した AI モデルを使ってスタートアップの請求書を処理するための請求書処理 AI モデルを作ります。

## Power Platform における生成 AI

Power Platform は生成 AI を用いて、ローコード開発とアプリケーションを強化するのが主な目的です。データサイエンスの専門知識がない人でも、AI を使ったアプリ、サイト、ダッシュボードの作成や、AI によるプロセスの自動化ができるようになるのが狙いです。これは、Copilot と AI Builder を通じて、Power Platform のローコード開発体験に生成 AI を取り込み実現します。

### どのように動作するのでしょうか？

Copilot は AI アシスタントで、自然言語を使って会話形式のやり取りで要件を説明し、Power Platform のソリューションを作れます。たとえば、アプリで使用するフィールドを AI アシスタントに指示すると、アプリとそれに基づくデータモデルの両方を作成します。また、Power Automate でフローを設定する方法を指定できます。

アプリ画面に Copilot の機能を組み込み、利用者は、会話型のやり取りを通じて、知見が得られるようになります。

AI Builder は、Power Platform で利用可能なローコード AI 機能で、AI モデルを使用してプロセスを自動化し、結果を予測できます。AI Builder を使用すると、Dataverse や SharePoint、OneDrive、Azure などの様々なクラウド上のデータソースに接続するアプリやフローに AI を組み込めます。

Copilot は、Power Apps、Power Automate、Power BI、Power Pages、Power Virtual Agents といった、全 Power Platform 製品で利用できます。一方で、AI Builder は Power Apps と Power Automate で利用できます。今回のレッスンでは、Power Apps と Power Automate における Copilot と AI Builder の使用方法について、特に教育スタートアップ用のソリューション開発の観点から詳しく説明していきます。

### Power Apps における Copilot

Power Platform の一部として、Power Apps は、データの追跡、管理、対話型のアプリを作成できる、ローコード開発環境を提供します。Power Apps は、スケーラブルなデータ・プラットフォームと、クラウドサービスやオンプレミス・データに接続できる力を備えたアプリ開発サービスを組み合わせた開発環境です。Power Apps を利用すると、ブラウザ、タブレット、携帯電話上で動作するアプリを作成し、同僚に共有できます。Power Apps はシンプルなインターフェースで、利用者が簡単にアプリを開発できるように作られており、全てのビジネス・利用者やプロの開発者がカスタム・アプリを作成できます。

Power Apps における Copilot AI アシスタント機能を利用すると、必要なアプリの種類や、アプリで追跡、収集、表示したい情報を説明できます。Copilot はその説明に基づいて、レスポンシブな（利用者が使用しているデバイスの画面サイズに応じて自動的にレイアウトを調整する）Canvas アプリを生成します。その後、アプリを自分のニーズに合わせてカスタマイズできます。また、AI Copilot は追跡したいデータを保存するための必要なフィールドをあらかじめ持っている Dataverse テーブルとサンプルデータを生成し、提案します。このレッスンの後半では、Dataverse とは何か、そして Power Apps でどのように使用するかを詳しく見ていきます。その後、会話でのやり取りを通じて AI Copilot アシスタント機能を使用してテーブルを自分のニーズに合わせてカスタマイズします。この機能は、Power Apps のホーム画面からすぐに利用できます。

### Power Automate における Copilot

Power Platform の一部である Power Automate は、利用者が、アプリケーションとサービス間で、自動化ワークフローの作成ができます。これにより、コミュニケーション、データ収集、承認決定などの反復的なビジネス・プロセスを自動化できます。そして、その簡単なインターフェースは、初心者から経験豊富な開発者まで、全ての技術レベルの利用者の作業タスクを自動化できます。またこうした、ワークフロー開発体験は Copilot を通じた生成型 AI で強化されます。

Power Automate における Copilot AI アシスタント機能を利用すると、必要なフローの種類や、フローで実行したいアクションを、それぞれ説明できます。Copilot はその説明に基づいて、フローを生成します。その後、フローをご自分のニーズに合わせてカスタマイズできます。また AI Copilot は、自動化したいタスクを実行するために必要なアクションを生成したり、提案してくれます。このレッスンの後半では、フローとは何か、Power Automate での活用方法を詳しく説明します。その後、会話でのやり取りを通じた AI Copilot のアシスタント機能を通じて、アクションを自分のニーズに合わせてカスタマイズします。この機能は、Power Automate のホーム画面からすぐに利用できます。

## 課題： スタートアップが Copilot を使用して学生の課題と請求書を管理する

スタートアップは、学生にオンラインコースを提供しています。スタートアップは急速に成長し、そのコースの需要に対応するのが難しくなっています。スタートアップはあなたを Power Platform 開発者として新たに採用し、学生の課題と請求書を管理するためのローコードソリューションを構築するように依頼しました。そのソリューションは、アプリを通じて学生の課題の追跡と管理を行い、ワークフローを通じて請求処理のプロセスを自動化するのに役立ちます。あなたは、ソリューションを開発するために生成 AI を使用するように指示されています。

Copilot を使い始める際には、[Power Platform Copilot Prompt Library](https://pnp.github.io/powerplatform-prompts/?WT.mc_id=academic-109639yoterada) を使用して、プロンプトを使い始めます。このライブラリには Copilot と共に、アプリやフローを作成するためのプロンプトのリストが含まれています。また、ライブラリ内のプロンプトを使用して、Copilot に対して要件をどのように説明できるのかといったアイデアを得られます。

### スタートアップによる学生課題追跡アプリの構築

スタートアップの教育者たちは、学生の課題を追跡するのに苦労しています。彼らは課題を追跡するためにスプレッドシートを使用していましたが、学生数が増加するにつれて管理が難しくなってきました。彼らはあなたに、学生の課題追跡と管理を手助けするアプリの作成を依頼しました。アプリは新しい課題の追加、課題の閲覧、課題の更新、課題の削除ができる必要があります。また、アプリは教育者と学生が共に、採点済みの課題と未採点の課題を閲覧できるように実装する必要があります。

下記の手順に従って、Power Apps の Copilot を利用してアプリを構築します：

1. [Power Apps](https://make.powerapps.com?WT.mc_id=academic-105485-yoterada) のホーム画面に遷移します。

1. ホーム画面のテキストエリアに、作成したいアプリを説明します。例えば、「**学生の課題を追跡し管理するアプリを作成してください**」と入力します。「**Send**」ボタンをクリックして、プロンプトを AI Copilot に送信します。

![Describe the app you want to build](../../images/copilot-chat-prompt-powerapps.png?WT.mc_id=academic-105485-yoterada)

1. AI Copilot は、追跡したいデータを保存するために必要なフィールドとサンプルデータを持つ Dataverse テーブルの作成を提案します。その後、会話でのやり取りを通じ AI Copilot のアシスタント機能を使用して、テーブルを自分のニーズに合わせてカスタマイズできます。

   > **重要**：Dataverse は Power Platform の基盤となるデータプラットフォームで、アプリのデータを保存するためのローコード・データ・プラットフォームです。Microsoft Cloud 上にデータを安全に保存する、完全にマネージドなサービスで、Power Platform 環境内でプロビジョニングできます。データ分類、データ系統、きめ細やかなアクセス制御など、組み込みのデータガバナンス機能が付属しています。Dataverse については[こちら](https://docs.microsoft.com/powerapps/maker/data-platform/data-platform-intro?WT.mc_id=academic-109639-yoterada)から詳しく学ぶべます。

   ![Suggested fields in your new table](../../images/copilot-dataverse-table-powerapps.png?WT.mc_id=academic-105485-yoterada)

1. 教育者は、課題を提出した学生に進行状況を伝えるためにメールを送りたいと考えています。その為に、Copilot を使用して、学生のメールアドレスを保存する新しいフィールドをテーブルに追加できます。例えば、「**学生のメールを保存する列を追加してください**」というプロンプトを使用して、新しいフィールドを追加できます。「**Send**」ボタンをクリックして、プロンプトを AI Copilot に送信します。

![Adding a new field](../../images/copilot-new-column.png?WT.mc_id=academic-105485-yoterada)

1. AI Copilot は新しいフィールドを生成し、その後、フィールドを自身のニーズに合わせてカスタマイズできます。

1. テーブルが完成した後、「**Create app**」ボタンをクリックしてアプリを作成します。

1. AI Copilot は記述内容に基づいてレスポンシブな Canvas アプリを生成します。その後、アプリを自分のニーズに合わせてカスタマイズできます。

1. 教育者が学生にメールを送るために、Copilot を使用してアプリに新しい画面を追加できます。例えば、次のプロンプトを使用してアプリに新しい画面を追加できます：「**_学生にメールを送る画面を追加してください_**」そして「**Send**」ボタンをクリックして、プロンプトを AI Copilot に送信します。

![Adding a new screen via a prompt instruction](../../images/copilot-new-screen.png?WT.mc_id=academic-105485-yoterada)

1. AI Copilot は新しい画面を生成し、その後、自身のニーズに合わせて画面をカスタマイズできます。

1. アプリが完成した後、「**Save**」ボタンをクリックしてアプリを保存します。

1. 教育者にアプリを共有するには、「**Share**」ボタンをクリックし、再度「**Share**」ボタンをクリックします。その後、教育者のメールアドレスを入力してアプリを共有できます。

> **課題**：今作ったアプリは良い起点ですが、まだ改善の余地があります。現在のメール機能は、教育者が学生のメールアドレスを手動で入力してメールを送るしかできません。課題を提出したときに、自動的に学生にメールを送る自動メール送信機能を Copilot を使用して構築できますか？ヒントは、適切なプロンプトを使用すれば、Power Automate の Copilot を使用して構築できます。

### スタートアップによる請求書情報テーブルを作成

スタートアップの財務部門は、請求書の追跡に苦労しています。彼らはスプレッドシートを使って請求書を追跡していましたが、請求書の数が増えるにつれて、管理が難しくなってきました。彼らはあなたに、受け取った請求書の情報を保存し、追跡したり、管理を手助けするアプリの作成を依頼しました。請求書情報を扱うテーブルは、すべての請求書情報を抽出し、それをテーブルに保存するまでの処理を自動化できるように実装します。またテーブルは、財務部門が支払い済みの請求書と未払いの請求書を、閲覧できるように実装します。

Power Platform には、アプリやソリューションのデータを保存するための基盤となるデータプラットフォーム、Dataverse が存在します。Dataverse はアプリのデータを保存するための、ローコード・データ・プラットフォームを提供し、Microsoft Cloud 上にデータを安全に保存するフルマネージドサービスです。これは Power Platform 環境内でプロビジョニングされ、データ分類、データの流れ、細かいアクセス制御などのデータ・ガバナンス機能も組み込まれています。Dataverse について詳しくは[こちら](https://docs.microsoft.com/powerapps/maker/data-platform/data-platform-intro?WT.mc_id=academic-109639-yoterada)をご覧ください。

なぜスタートアップで Dataverse を使うべきなのでしょうか？Dataverse 内の標準テーブルとカスタムテーブルは、クラウド・ベースの安全なストレージ・オプションを提供します。テーブルを使うと、一つの Excel ワークブック内で複数のワークシートを使うのと同じように、さまざまな種類のデータを保存できます。組織やビジネスニーズに特化したデータをテーブルに保存が可能です。スタートアップが Dataverse を使って得られる利点は下記のような物があります。

- **管理が容易**：メタデータとデータはクラウドに保存されるため、その保存や管理の詳細について心配する必要はありません。アプリケーションやソリューションの構築に集中できます。

- **安全**：Dataverse はクラウドベースの安全なストレージオプションを提供します。ロールベースのセキュリティを使用し、テーブル内のデータへのアクセスを誰が、どのように行うか制御できます。

- **豊富なメタデータ**：データ型とリレーションシップは Power Apps 内で直接利用されます。

- **ロジックと検証**：ビジネスルール、計算列、検証ルールを使い、ビジネスロジックを適用し、データの正当性を維持できます。

Dataverse とは何か、そしてその利点を理解したところで、Copilot を使って Dataverse でテーブルを作成し、財務チームの要件を満たすテーブル作成方法を見ていきましょう。

> **注**：次のセクションでは、このテーブルを使って、すべての請求書情報を抽出し、そこからテーブルに保存するまでの自動化処理を構築します。

Copilot を使って Dataverse でテーブルを作成する手順は下記の通りです：

1. [Power Apps](https://make.powerapps.com?WT.mc_id=academic-105485-yoterada) のホーム画面に遷移します。

2. 左側のナビゲーションバーで「テーブル」を選択し、「Describe the new Table」をクリックします。

![Select new table](../../images/describe-new-table.png?WT.mc_id=academic-105485-yoterada)

3. 「Describe the new Table」画面で、テキストエリアに作成したいテーブルの内容を記述します。例えば、「請求書情報を保存するテーブルを作成してください」と入力します。「送信」ボタンをクリックして、この指示を AI Copilot に送ります。

![Describe the table](../../images/copilot-chat-prompt-dataverse.png?WT.mc_id=academic-105485-yoterada)

4. AI Copilot は、追跡したいデータを保存するために必要なフィールドといくつかのサンプルデータを含む Dataverse テーブルを提案します。その後、会話形式のやり取りを通じて AI Copilot アシスタント機能を使い、自分のニーズに合わせてテーブルをカスタマイズできます。

![Suggested Dataverse table](../../images/copilot-dataverse-table.png?WT.mc_id=academic-105485-yoterada)

5. 財務チームは、サプライヤーにメールを送り、請求書の現在のステータスを更新したいと考えています。Copilot を使って、サプライヤーのメールを保存する新しいフィールドをテーブルに追加できます。例えば、「サプライヤーのメールを保存する列を追加してください」という指示を入力します。「送信」ボタンをクリックして、この指示を AI Copilot に送ります。

6. AI Copilot は新しいフィールドを生成し、そのフィールドを自分のニーズに合わせてカスタマイズできます。

7. テーブルの作成が完了したら、「作成」ボタンをクリックしてテーブルを作成します。

## AI Builder を使った Power Platform の AI モデル

AI Builder は Power Platform で利用可能なローコード AI 機能で、プロセスの自動化や結果の予測を支援する AI モデルを使用できます。AI Builder を使えば、Dataverse や SharePoint、OneDrive、Azure などのさまざまなクラウド・データソースに接続するアプリやフローに AI を導入できます。

## 事前構築済み AI モデルとカスタム AI モデル

AI Builder は、事前構築済み AI モデルとカスタム AI モデルの 2 種類の AI モデルを提供します。事前構築済み AI モデルは、Microsoft がトレーニングしたすぐに使用できる AI モデルで、Power Platform で利用可能です。これらのモデルを使うと、データを収集して独自のモデルを構築、トレーニング、公開せずに、アプリやフローにインテリジェンスな機能を追加できます。これらのモデルを使ってプロセスを自動化したり、結果を予測できます。

Power Platform で利用可能な事前構築済み AI モデルには以下のようなものがあります：

- **キーフレーズ抽出**：このモデルはテキストからキーフレーズを抽出します。
- **言語検出**：このモデルはテキストの言語を検出します。
- **感情分析**：このモデルはテキスト内の肯定的、否定的、中立的、または混合した感情を検出します。
- **名刺リーダー**：このモデルは名刺から情報を抽出します。
- **テキスト認識**：このモデルは画像からテキストを抽出します。
- **物体検出**：このモデルは画像から物体を検出して抽出します。
- **文書処理**：このモデルはフォームから情報を抽出します。
- **請求書処理**：このモデルは請求書から情報を抽出します。

カスタム AI モデルを使うと、自分のモデルを AI Builder に取り込んで、AI Builder のカスタムモデルと同様に機能させ、自分のデータを使ってモデルをトレーニングできます。これらのモデルを使って、Power Apps と Power Automate の両方でプロセスを自動化し、結果を予測できます。自分のモデルを使用する場合、使用に関して制限があります。これらの制限について、詳しくは[こちら](https://learn.microsoft.com/ai-builder/byo-model#limitations?WT.mc_id=academic-105485-yoterada)をご覧ください。

![AI builder models](../../images/ai-builder-models.png?WT.mc_id=academic-105485-yoterada)

## 課題#2 - スタートアップによる請求書処理フローの構築

財務チームは請求書の処理に苦労しています。彼らはスプレッドシートを使って請求書を追跡していましたが、請求書の数が増えるにつれて管理が難しくなってきました。そこで、AI を使って請求書を処理するワークフローの構築を依頼されました。このワークフローでは、請求書から情報を抽出し、その情報を Dataverse テーブルに保存しなければなりません。また、抽出した情報を財務チームにメールで送信する必要もあります。

AI Builder とは何か、なぜそれを使うべきなのかを理解したところで、先ほど説明した AI Builder の請求書処理 AI モデルを使って、財務チームが請求書を処理するのに役立つワークフローを構築する方法を見ていきましょう。

AI Builder の請求書処理 AI モデルを使って、財務チームが請求書を処理するのに役立つワークフローを構築するには、下記の手順を実行します：

1. [Power Automate](https://make.powerautomate.com?WT.mc_id=academic-105485-yoterada) のホーム画面に遷移します。

2. ホーム画面のテキストエリアを使って、構築したいワークフローを記述します。例えば、「メールボックスに請求書が届いたら処理を開始してください」と入力します。「送信」ボタンをクリックして、この指示を AI Copilot に送ります。

   ![Copilot power automate](../../images/copilot-chat-prompt-powerautomate.png?WT.mc_id=academic-105485-yoterada)

3. AI Copilot は、自動化したいタスクを実行するために必要なアクションを提案します。「次へ」ボタンをクリックすると、次のステップに進めます。

4. 次のステップでは、Power Automate がフローに必要な接続の設定を求めます。設定が完了したら、「フローの作成」ボタンをクリックしてフローを作成します。

5. AI Copilot はフローを生成し、その後、フローを自分のニーズに合わせてカスタマイズできます。

6. フローのトリガーを更新し、請求書が保存されるフォルダーを指定します。例えば、「受信トレイ」を指定できます。「詳細オプションの表示」をクリックし、「添付ファイルのみ」で「はい」に設定します。これにより、添付ファイル付きのメールがフォルダーに届いたときだけフローが実行されます。

7. 「HTML からテキストへ」、「Compose」、「Compose 2」、「Compose 3」、「Compose 4」のアクションは使用しないため、フローから削除します。

8. 「条件」アクションも使用しないため、フローから削除します。次のスクリーンショットのようになります。

   ![power automate, remove actions](../../images/powerautomate-remove-actions.png?WT.mc_id=academic-105485-yoterada)

9. 「アクションの追加」ボタンをクリックし、「Dataverse」を検索します。「新しい行の追加」アクションを選択します。

10. 「請求書から情報を抽出」アクションで、請求書ファイルをメールの「添付ファイルの内容」を指すように更新します。これにより、フローが添付ファイルの請求書から情報を抽出するようになります。

11. 前に作成した「テーブル」を選択します。例えば、「請求書情報」テーブルを選択できます。前のアクションの動的コンテンツを選択して、次のフィールドに入力します：

    - ID
    - 金額
    - 日付
    - 名前
    - ステータス - 「ステータス」を「保留中」に設定します。
    - サプライヤーメール - 「新しいメールが届いたとき」にトリガーを呼び出し「送信者」を動的コンテンツとして使用します。

    ![power automate add row](../../images/powerautomate-add-row.png?WT.mc_id=academic-105485-yoterada)

12. フローの設定が完了したら、「保存」ボタンをクリックしてフローを保存します。その後、トリガーで指定したフォルダーに請求書を含むメールを送信し、フローをテストできます。

> **課題**：今作成したフローは良いスタート地点ですが、まだ改善ポイントがあります。次に、財務部門がサプライヤーにメールを送信し、請求書の現在の状況を更新できるような自動化処理を実装する方法を考える必要があります。ヒント：フローは、請求書の状況が変更されたときに実行する必要があります。

## Power Automate でテキスト生成 AI モデルを使用

AI Builder の GPT モデルを使った「テキストの生成」機能は、プロンプトに基づいてテキストを生成するもので、Microsoft Azure OpenAI Service で提供されています。この機能を使えば、GPT（Generative Pre-Trained Transformer）テクノロジーをアプリやフローに組み込み、さまざまな自動化フローや知見に満ちたアプリケーションを構築できます。

GPT モデルは、膨大な量のデータに対して広範囲なトレーニングを行い、プロンプトが与えられると、人間の言葉による表現によく似たテキストを生成できます。ワークフローの自動化と統合し、GPT などの AI モデルを活用して、さまざまなタスクを合理化し、自動化できます。

例えば、メールの下書きや商品説明を自動生成するフローを作れます。また、このモデルを使えば、チャットボットや顧客サービス・アプリで、顧客からの問い合わせに対して効率的に対応するテキストも生成できます。

![create a prompt](../../images/create-prompt-gpt.png?WT.mc_id=academic-105485-yoterada)

Power Automate でこの AI モデルを使用する方法については、[AI Builder と GPT を使ってインテリジェンスな機能を追加する](https://learn.microsoft.com/training/modules/ai-builder-text-generation/?WT.mc_id=academic-109639-yoterada)をご参照ください。

## お疲れ様でした!　学習を続ける

このレッスン修了後、[生成 AI 学習コレクション](https://aka.ms/genai-collection?WT.mc_id=academic-105485-yoterada) をチェックして、生成 AI の知識をレベルアップさせましょう。

次のレッスン 11 では、[Function Calling との統合](../../../11-integrating-with-function-calling/translations/ja-jp/README.md?WT.mc_id=academic-105485-yoterada)について学びます！
